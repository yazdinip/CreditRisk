schema: '2.0'
stages:
  train_baseline:
    cmd: python -X faulthandler -m creditrisk.pipelines.train_baseline --config configs/baseline.yaml
    deps:
    - path: configs/baseline.yaml
      hash: md5
      md5: a27201e831ec5435a5e1b029d87f7246
      size: 7967
    - path: data/processed/test.parquet
      hash: md5
      md5: 61a6dbc36d152a44d6fd0af82f0eb579
      size: 11252275
    - path: data/processed/train.parquet
      hash: md5
      md5: 79475840607c324250654a4e806f4f14
      size: 40991363
    - path: src/creditrisk/config.py
      hash: md5
      md5: ebe1d735c3a1b682a4cd80b15f76e4ea
      size: 16735
    - path: src/creditrisk/data/datasets.py
      hash: md5
      md5: c6f52053ac188a5cd80628ac7ee26d80
      size: 1766
    - path: src/creditrisk/features/preprocess.py
      hash: md5
      md5: b1b88832300444941670e9eca699f87d
      size: 6547
    - path: src/creditrisk/models/baseline.py
      hash: md5
      md5: 447d7a1d4616dca78aa31d436c46dedc
      size: 6035
    - path: src/creditrisk/pipelines/data_workflow.py
      hash: md5
      md5: 9d172e75a5ea2969c7a97cc8ac95deb1
      size: 6908
    - path: src/creditrisk/pipelines/train_baseline.py
      hash: md5
      md5: ef59fbc7b4eb02823a951ab7c5b5ccf6
      size: 9114
    - path: src/creditrisk/utils/evaluation.py
      hash: md5
      md5: 6dc4202f0234e7371386e05b14f8d6cb
      size: 3624
    - path: src/creditrisk/validation/contracts.py
      hash: md5
      md5: a0c94f10fbddf98c934d3067438835bb
      size: 6038
    - path: src/creditrisk/validation/runner.py
      hash: md5
      md5: 83c54a20435e1ad9e54dc0fe10e22c37
      size: 5790
    params:
      configs/baseline.yaml:
        data.raw_path: data/raw/application_train.csv
        data.target_column: TARGET
        model.type: xgboost
        training.class_weight: balanced
        training.random_state: 42
        training.test_size: 0.2
    outs:
    - path: models/baseline_model.joblib
      hash: md5
      md5: 8961b4bf74a1fa98d246c77c62858043
      size: 1242274
    - path: reports/evaluation
      hash: md5
      md5: c191cd411b011fe181c93ed7f352cc06.dir
      size: 143983
      nfiles: 5
    - path: reports/metrics.json
      hash: md5
      md5: 9fbe15654303f9ad96c0d60838a744e9
      size: 214
  build_feature_store:
    cmd: python -X faulthandler -m creditrisk.pipelines.build_feature_store --config
      configs/baseline.yaml
    deps:
    - path: configs/baseline.yaml
      hash: md5
      md5: a27201e831ec5435a5e1b029d87f7246
      size: 7967
    - path: data/raw/POS_CASH_balance.csv
      hash: md5
      md5: 5ff35c48093c873baec6edc9090bd2e5
      size: 392703158
    - path: data/raw/application_train.csv
      hash: md5
      md5: 793a017f41fbac1dc28176b26dbab30e
      size: 166133370
    - path: data/raw/bureau.csv
      hash: md5
      md5: ec0f59a16e7071de66b83217b23bb390
      size: 170016717
    - path: data/raw/bureau_balance.csv
      hash: md5
      md5: 5e815ea6eb338752724bcf46da13c602
      size: 375592889
    - path: data/raw/credit_card_balance.csv
      hash: md5
      md5: ff83bfc2285d218802c6dff749bc5efc
      size: 424582605
    - path: data/raw/installments_payments.csv
      hash: md5
      md5: 4e9751972d02c376f0e75edbf6c9d07d
      size: 723118349
    - path: data/raw/previous_application.csv
      hash: md5
      md5: bd1eb5f08a4700414db1742e5cc0f9fa
      size: 404973293
    - path: reports/ingestion_summary.json
      hash: md5
      md5: 32acf3ad779ca5014d8230c1f3127e3b
      size: 1589
    - path: src/creditrisk/config.py
      hash: md5
      md5: ebe1d735c3a1b682a4cd80b15f76e4ea
      size: 16735
    - path: src/creditrisk/data/datasets.py
      hash: md5
      md5: c6f52053ac188a5cd80628ac7ee26d80
      size: 1766
    - path: src/creditrisk/features/feature_store.py
      hash: md5
      md5: e571aedb92be83f62c1d7b16e3e47a87
      size: 16618
    - path: src/creditrisk/features/preprocess.py
      hash: md5
      md5: b1b88832300444941670e9eca699f87d
      size: 6547
    - path: src/creditrisk/pipelines/build_feature_store.py
      hash: md5
      md5: 9b0ae24f9003dc07aa655db94608efc7
      size: 1460
    - path: src/creditrisk/pipelines/data_workflow.py
      hash: md5
      md5: 9d172e75a5ea2969c7a97cc8ac95deb1
      size: 6908
    - path: src/creditrisk/validation/contracts.py
      hash: md5
      md5: a0c94f10fbddf98c934d3067438835bb
      size: 6038
    - path: src/creditrisk/validation/runner.py
      hash: md5
      md5: 83c54a20435e1ad9e54dc0fe10e22c37
      size: 5790
    outs:
    - path: data/processed/feature_store.parquet
      hash: md5
      md5: 6128f1d61f0618b228e6595b6af69e57
      size: 49897947
  split_data:
    cmd: python -X faulthandler -m creditrisk.pipelines.split_data --config configs/baseline.yaml
    deps:
    - path: configs/baseline.yaml
      hash: md5
      md5: a27201e831ec5435a5e1b029d87f7246
      size: 7967
    - path: data/processed/feature_store.parquet
      hash: md5
      md5: 6128f1d61f0618b228e6595b6af69e57
      size: 49897947
    - path: src/creditrisk/config.py
      hash: md5
      md5: ebe1d735c3a1b682a4cd80b15f76e4ea
      size: 16735
    - path: src/creditrisk/data/datasets.py
      hash: md5
      md5: c6f52053ac188a5cd80628ac7ee26d80
      size: 1766
    - path: src/creditrisk/pipelines/data_workflow.py
      hash: md5
      md5: 9d172e75a5ea2969c7a97cc8ac95deb1
      size: 6908
    - path: src/creditrisk/pipelines/split_data.py
      hash: md5
      md5: 8dc276bf1e4ff8da76cc5adf54590664
      size: 2696
    - path: src/creditrisk/validation/contracts.py
      hash: md5
      md5: a0c94f10fbddf98c934d3067438835bb
      size: 6038
    - path: src/creditrisk/validation/runner.py
      hash: md5
      md5: 83c54a20435e1ad9e54dc0fe10e22c37
      size: 5790
    outs:
    - path: data/processed/test.parquet
      hash: md5
      md5: 61a6dbc36d152a44d6fd0af82f0eb579
      size: 11252275
    - path: data/processed/train.parquet
      hash: md5
      md5: 79475840607c324250654a4e806f4f14
      size: 40991363
  validate_model:
    cmd: python -X faulthandler -m creditrisk.testing.post_training --config configs/baseline.yaml
      --metrics-file reports/test_metrics.json --evaluation-dir reports/test_evaluation
    deps:
    - path: configs/baseline.yaml
      hash: md5
      md5: a27201e831ec5435a5e1b029d87f7246
      size: 7967
    - path: mlruns
      hash: md5
      md5: 375bccfa3e39a06b8e4dcba3514966a0.dir
      size: 11213732
      nfiles: 379
    - path: reports/test_evaluation
      hash: md5
      md5: c191cd411b011fe181c93ed7f352cc06.dir
      size: 143983
      nfiles: 5
    - path: reports/test_metrics.json
      hash: md5
      md5: 9fbe15654303f9ad96c0d60838a744e9
      size: 214
    - path: src/creditrisk/config.py
      hash: md5
      md5: ebe1d735c3a1b682a4cd80b15f76e4ea
      size: 16735
    - path: src/creditrisk/testing/post_training.py
      hash: md5
      md5: 1340a7e67ff46ee44dfa341392a73ce6
      size: 12276
    outs:
    - path: reports/post_training_validation.json
      hash: md5
      md5: 7008fa6191e6d7289f434c734ec5eeff
      size: 1794
  test_model:
    cmd: python -X faulthandler -m creditrisk.testing.test_dataset --config configs/baseline.yaml
      --metrics-file reports/test_metrics.json --predictions-file reports/test_predictions.parquet
      --evaluation-dir reports/test_evaluation
    deps:
    - path: configs/baseline.yaml
      hash: md5
      md5: a27201e831ec5435a5e1b029d87f7246
      size: 7967
    - path: data/processed/test.parquet
      hash: md5
      md5: 61a6dbc36d152a44d6fd0af82f0eb579
      size: 11252275
    - path: models/baseline_model.joblib
      hash: md5
      md5: 8961b4bf74a1fa98d246c77c62858043
      size: 1242274
    - path: src/creditrisk/config.py
      hash: md5
      md5: ebe1d735c3a1b682a4cd80b15f76e4ea
      size: 16735
    - path: src/creditrisk/data/datasets.py
      hash: md5
      md5: c6f52053ac188a5cd80628ac7ee26d80
      size: 1766
    - path: src/creditrisk/models/baseline.py
      hash: md5
      md5: 447d7a1d4616dca78aa31d436c46dedc
      size: 6035
    - path: src/creditrisk/pipelines/data_workflow.py
      hash: md5
      md5: 9d172e75a5ea2969c7a97cc8ac95deb1
      size: 6908
    - path: src/creditrisk/testing/test_dataset.py
      hash: md5
      md5: 7efe2261a29b8dc088336e7cf0ba7d99
      size: 5948
    - path: src/creditrisk/utils/evaluation.py
      hash: md5
      md5: 6dc4202f0234e7371386e05b14f8d6cb
      size: 3624
    outs:
    - path: reports/test_evaluation
      hash: md5
      md5: c191cd411b011fe181c93ed7f352cc06.dir
      size: 143983
      nfiles: 5
    - path: reports/test_metrics.json
      hash: md5
      md5: 9fbe15654303f9ad96c0d60838a744e9
      size: 214
    - path: reports/test_predictions.parquet
      hash: md5
      md5: 21a2b997ccb9cd4da32b018e38fd4eab
      size: 808153
  ingest_data:
    cmd: python -X faulthandler -m creditrisk.pipelines.ingest_data --config configs/baseline.yaml
    deps:
    - path: configs/baseline.yaml
      hash: md5
      md5: a27201e831ec5435a5e1b029d87f7246
      size: 7967
    - path: src/creditrisk/config.py
      hash: md5
      md5: ebe1d735c3a1b682a4cd80b15f76e4ea
      size: 16735
    - path: src/creditrisk/pipelines/ingest_data.py
      hash: md5
      md5: dac334a5a5617bd089be045b97bf8753
      size: 4611
    outs:
    - path: reports/ingestion_summary.json
      hash: md5
      md5: 32acf3ad779ca5014d8230c1f3127e3b
      size: 1589
  monitor_drift:
    cmd: python -X faulthandler -m creditrisk.monitoring.drift --config configs/baseline.yaml
    deps:
    - path: configs/baseline.yaml
      hash: md5
      md5: a27201e831ec5435a5e1b029d87f7246
      size: 7967
    - path: data/processed/test.parquet
      hash: md5
      md5: 61a6dbc36d152a44d6fd0af82f0eb579
      size: 11252275
    - path: data/processed/train.parquet
      hash: md5
      md5: 79475840607c324250654a4e806f4f14
      size: 40991363
    - path: src/creditrisk/config.py
      hash: md5
      md5: ebe1d735c3a1b682a4cd80b15f76e4ea
      size: 16735
    - path: src/creditrisk/monitoring/__init__.py
      hash: md5
      md5: a1dc4cc970766510f205a55268940913
      size: 189
    - path: src/creditrisk/monitoring/drift.py
      hash: md5
      md5: d538d3c7252ead4a1148aad525759e4b
      size: 12132
    - path: src/creditrisk/pipelines/data_workflow.py
      hash: md5
      md5: 9d172e75a5ea2969c7a97cc8ac95deb1
      size: 6908
    outs:
    - path: reports/drift_report.html
      hash: md5
      md5: 0678e184a0d55e0b22b8c0c6bf3fd144
      size: 4687
    - path: reports/drift_report.json
      hash: md5
      md5: 24871993d4b2215fada140e5b866fd59
      size: 8411
