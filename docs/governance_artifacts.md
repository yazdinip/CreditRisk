# Governance & Monitoring Artifacts

This pipeline emits a set of JSON/HTML artefacts on every run to provide full lineage, drift awareness, and data freshness guarantees.

## Data Lineage
- **`reports/data_lineage.json`** – captures source dataset checksums/URIs, config hash, code version (git/DVC), and downstream outputs. Use this to trace any model decision back to exact inputs.
- **`reports/ingestion_summary.json`** – per-source metadata (resolved URI, size, checksum, timestamp) for raw ingests. Feeds lineage and freshness checks.
- **`dvc.lock`** – DVC’s reproducibility record linking code hashes to data hashes for every stage.

## Model Artefacts & Validation
- **`models/creditrisk_pd_model.joblib`** – serialized estimator used by FastAPI/batch.
- **`reports/metrics.json` / `reports/test_metrics.json`** – train/test evaluation metrics.
- **`reports/post_training_validation.json`** – contract between local artefacts and MLflow run; ensures the model logged matches what’s on disk.
- **`reports/registry_promotion.json` / `reports/registry_transition.json`** – promotion decision and registry state changes.

## Drift Monitoring
- **`reports/drift_report.{json,html}`** – Evidently/K-S drift between train and test/reference splits (DVC stage `monitor_drift`).
- **`reports/production_drift_report.{json,html}`** – drift between training reference and current production pull (`creditrisk.monitoring.production`). Optional CloudWatch metrics if creds are present.
- **`reports/drift_metrics.json`** – summary payload from production drift runs.
- **`reports/canary_report.json`** – canary comparison between candidate and current production model.
- **Promotion gating** – currently drift reports are artefacts only; registry promotion is driven by eval metrics/thresholds. If you want drift to block promotion, add a CI/CD step that fails when `dataset_drift` is true or the drift share exceeds your tolerance.

## Data Freshness
- **`reports/data_freshness.json`** – derived from `reports/ingestion_summary.json`; flags stale/missing feeds based on SLA. Enforced in nightly/CD pipelines to prevent shipping against old data.

## Deployment & Ops
- **`reports/deploy_manifest.json`** – manifest of model path, Dockerfiles, CI/CD workflow, registry metadata for release engineers.
- **`reports/retrain_trigger.json`** – records whether production drift crossed thresholds and if an auto-retrain would run (or did run when enabled).
- **`reports/canary_report.json`** – canary deltas to gate deployment.

## Where to Find Them
- Git-tracked outputs live under `reports/` and `models/` after `dvc repro validate_model`.
- Production drift and retrain triggers are generated by `creditrisk.monitoring.production` (DVC stage or Airflow task).
- Lineage is reinforced by `dvc.lock` + `reports/data_lineage.json` and the ingestion summary.
